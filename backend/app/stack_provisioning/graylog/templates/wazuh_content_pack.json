{
  "id":"b8efc7f0-0e41-4f5c-b480-4386e0263452",
  "rev":1,
  "v":"1",
  "name":"SOCFORTRESS_WAZUH_CONTENT_PACK_NOV_2023",
  "summary":"SOCFORTRESS_WAZUH_CONTENT_PACK_NOV_2023",
  "description":"",
  "vendor":"SOCFortress",
  "url":"",
  "created_at":"2024-02-01T03:38:13.597Z",
  "server_version":"5.0.13+083613e",
  "parameters":[
  ],
  "entities":[
  {
  "id":"353eacf1-a0dc-4c76-9bb9-99212f90b15f",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Osquery Epoch Timestamp - UTC"
  },
  "description":{
  "@type":"string",
  "@value":"Osquery Epoch Timestamp - UTC"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Osquery Epoch Timestamp - UTC\"\nwhen\n has_field(\"data_unixTime\")\nthen\n let ts_millis = to_long($message.data_unixTime) * 1000;\n let new_date = parse_unix_milliseconds(ts_millis);\n set_field(\"timestamp_utc\", new_date);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"ac2f38f4-ae09-49f4-8261-0b8fa3d9c704",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX PACKETBEAT DNS LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX PACKETBEAT DNS LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX PACKETBEAT DNS LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"dns\"\nthen\n set_field(\"dns_query\", $message.data_dns_question_name);\n set_field(\"dns_answer\", $message.data_dns_resolved_ip);\n set_field(\"dns_response_code\", $message.data_dns_response_code);\n remove_field(\"$message.data_@metadata_beat\");\n remove_field(\"$message.data_@metadata_type\");\n remove_field(\"$message.data_@metadata_version\");\n remove_field(\"$message.data_agent_ephemeral_id\");\n remove_field(\"$message.data_host_architecture\");\n remove_field(\"$message.data_host_containerized\");\n remove_field(\"$message.data_host_hostname\");\n remove_field(\"$message.data_host_id\");\n remove_field(\"$message.data_host_ip\");\n remove_field(\"$message.data_host_mac\");\n remove_field(\"$message.data_host_name\");\n remove_field(\"$message.data_host_os_codename\");\n remove_field(\"$message.data_host_os_family\");\n remove_field(\"$message.data_host_os_kernel\");\n remove_field(\"$message.data_host_os_name\");\n remove_field(\"$message.data_host_os_platform\");\n remove_field(\"$message.data_host_os_type\");\n remove_field(\"$message.data_host_os_version\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"7c882c67-23a7-4815-8d0c-61b73d4e8115",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 17 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 17 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 17 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_17\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"pipe_name\", $message.data_win_eventdata_pipeName);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"86437950-7bf9-4922-bf1a-831c34a8a103",
  "type":{
  "name":"lookup_cache",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"network-ports"
  },
  "title":{
  "@type":"string",
  "@value":"Network Ports"
  },
  "description":{
  "@type":"string",
  "@value":"Cache of common network ports"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"guava_cache"
  },
  "max_size":{
  "@type":"integer",
  "@value":1000
  },
  "expire_after_access":{
  "@type":"long",
  "@value":60
  },
  "expire_after_access_unit":{
  "@type":"string",
  "@value":"SECONDS"
  },
  "expire_after_write":{
  "@type":"long",
  "@value":0
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"6371baab-8d09-445d-b721-bd59cc581e19",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - NETWORK PORTS"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - NETWORK PORTS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 - NETWORK PORTS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\" AND has_field(\"data_win_eventdata_destinationPort\")\nthen\n let ldata = lookup_value(\n lookup_table: \"network-ports\",\n key: to_string($message.data_win_eventdata_destinationPort)\n );\n set_field(\"port_common\", ldata);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"5471644e-57e7-4011-947c-7f71abf57bae",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 22 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 22 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 22 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_22\" AND ! has_field(\"misp_category\") AND $message.data_win_eventdata_queryName != \"NT AUTHORITY\" AND $message.data_win_eventdata_queryName != \"AUTORIDADE NT\" AND $message.data_win_eventdata_queryName != \"????\"\nthen\n let ldata = lookup(\n lookup_table: \"opencti_query\",\n key: to_string($message.data_win_eventdata_queryName)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e979fa4c-bab2-44c6-b13c-1627917c2519",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"parse_iso8601_timestamp"
  },
  "description":{
  "@type":"string",
  "@value":"parse_iso8601_timestamp"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"parse_iso8601_timestamp\"\nwhen\n has_field(\"timestamp\")\nthen\n let new_timestamp = parse_date(to_string($message.timestamp), \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\");\n set_field(\"timestamp\", new_timestamp);\nend\n"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"3135dccd-619c-4670-87c8-51650199361d",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSQUERY PROCESS HASH - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"OSQUERY PROCESS HASH - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSQUERY PROCESS HASH - OPENCTI THREAT INTEL\"\nwhen\n $message.data_osquery_name == \"processes_hash\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_hash\",\n key: to_string($message.data_osquery_columns_sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"0c1dfaa8-932c-44cd-9394-2a752802f14d",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WAZUH CREATE FIELD SYSLOG LEVEL - ALERT"
  },
  "description":{
  "@type":"string",
  "@value":"CREATE FIELD SYSLOG LEVEL - ALERT"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WAZUH CREATE FIELD SYSLOG LEVEL - ALERT\"\nwhen to_long($message.rule_level) > 11\nthen\nset_field(\"syslog_level\", \"ALERT\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"0860b3ee-40ee-46f8-96fd-d9226d672ed1",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"PACKETBEAT DNS QUERY - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"PACKETBEAT DNS QUERY - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"PACKETBEAT DNS QUERY - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"dns\"\nthen\n let dns_question_name_and_ampersand = concat(to_string($message.data_dns_question_name), \"&customer_code=\");\n let new_key = concat(dns_question_name_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"99d13022-39be-42b1-8d1d-d8bb282415a7",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - EMPTY SOFTWARE VENDORS"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - EMPTY SOFTWARE VENDORS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 1 - EMPTY SOFTWARE VENDORS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event1\" AND ! has_field(\"data_win_eventdata_company\")\nthen\n set_field(\"software_approved\", \"no\");\n let build_message_0 = to_string(\" Sysmon - Event 1: Process creation With Empty Company Name - \");\n let build_message_1 = concat(build_message_0, to_string($message.data_win_eventdata_image));\n set_field(\"second_rule_description\", build_message_1);\n set_field(\"syslog_level\", \"WARNING\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"32c38af3-7709-4cf9-8b1c-5ccac7c76354",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WAZUH CREATE FIELD SYSLOG LEVEL - WARNING"
  },
  "description":{
  "@type":"string",
  "@value":"CREATE FIELD SYSLOG LEVEL - WARNING"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WAZUH CREATE FIELD SYSLOG LEVEL - WARNING\"\nwhen to_long($message.rule_level) > 7 AND to_long($message.rule_level) < 12\nthen\nset_field(\"syslog_level\", \"WARNING\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"3b94c0f2-4817-4ec9-90d4-d82712df8261",
  "type":{
  "name":"lookup_adapter",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"ask-socfortress-windows"
  },
  "title":{
  "@type":"string",
  "@value":"ASK SOCFortress - Windows"
  },
  "description":{
  "@type":"string",
  "@value":"ASK SOCFortress for Windows SIGMA"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"httpjsonpath"
  },
  "url":{
  "@type":"string",
  "@value":"https://api.socfortress.co/v1/sigma?name=${key}"
  },
  "single_value_jsonpath":{
  "@type":"string",
  "@value":"$.message"
  },
  "user_agent":{
  "@type":"string",
  "@value":"Graylog Lookup - https://www.graylog.org/"
  },
  "headers":{
  "Content-Type":{
  "@type":"string",
  "@value":"application/json"
  },
  "module-version":{
  "@type":"string",
  "@value":"1.0"
  },
  "x-api-key":{
  "@type":"string",
  "@value":"ozH1jHp1zmacCePYrAZmxarJCGptcMth93a86Jq8"
  },
  "product":{
  "@type":"string",
  "@value":"windows"
  }
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"322a7f12-c4e9-4d8c-8f07-1bbc34375b16",
  "type":{
  "name":"lookup_cache",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"ask-socfortress-windows"
  },
  "title":{
  "@type":"string",
  "@value":"ASK SOCFortress - Windows"
  },
  "description":{
  "@type":"string",
  "@value":"ASK SOCFortress - Windows"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"guava_cache"
  },
  "max_size":{
  "@type":"integer",
  "@value":1000
  },
  "expire_after_access":{
  "@type":"long",
  "@value":5
  },
  "expire_after_access_unit":{
  "@type":"string",
  "@value":"MINUTES"
  },
  "expire_after_write":{
  "@type":"long",
  "@value":0
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"f8fd3bd0-3181-4d3c-a899-22ba81314750",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OpenAudit Remove field - data_system_software_item_install_date"
  },
  "description":{
  "@type":"string",
  "@value":"OpenAudit Remove field - data_system_software_item_install_date"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OpenAudit Remove field - data_system_software_item_install_date\"\nwhen\n // Apply the rule when the specified field is present\n has_field(\"data_system_software_item_install_date\")\nthen\n // Remove the specified field\n remove_field(\"data_system_software_item_install_date\");\nend\n"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"66987557-12e2-482a-8ec7-fd30ed4c7486",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"EPSS CVE Criticality"
  },
  "description":{
  "@type":"string",
  "@value":"EPSS CVE Criticality"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"EPSS CVE Criticality\"\nwhen\n $message.rule_group1 == \"vulnerability-detector\"\nthen\n let ldata = lookup(\n lookup_table: \"epss\",\n key: to_string($message.data_vulnerability_cve)\n );\n set_fields(\n fields: ldata,\n prefix: \"epss_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"15cbd36c-2284-4cbd-8dc7-29a84c6dd8b6",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - EMPTY SOFTWARE VENDORS"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - EMPTY SOFTWARE VENDORS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 7 - EMPTY SOFTWARE VENDORS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event7\" AND ! has_field(\"data_win_eventdata_company\")\nthen\n let ldata = lookup_value(\n lookup_table: \"software-vendors\",\n key: to_string($message.data_win_eventdata_signature)\n );\n set_field(\"software_approved\", ldata);\n let build_message_0 = to_string(\" Sysmon - Event 7: Image Loaded With Empty Company Name - \");\n let build_message_1 = concat(build_message_0, to_string($message.data_win_eventdata_signature));\n set_field(\"rule_description\", build_message_1);\n set_field(\"syslog_level\", \"WARNING\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"abd29517-ecea-483e-8f1d-c0393c3f3db6",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Timestamp Failsafe - UTC"
  },
  "description":{
  "@type":"string",
  "@value":"Set Timestamp based upon `msg_timestamp` field which is the time Graylog ingested the message. This is a failsafe to catch if no other field names have been detected in the log that provide the timestamp value that the host assigned with the raw alert."
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Timestamp Failsafe - UTC\"\nwhen\n ! has_field(\"timestamp_utc\")\nthen\n let msg_timestamp = $message.msg_timestamp;\n set_field(\"timestamp_utc\", msg_timestamp);\n remove_field(\"msg_timestamp\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"786c5f3e-0435-4895-a13c-29f897f5878c",
  "type":{
  "name":"lookup_adapter",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"nist-800-53-to-cui-controls"
  },
  "title":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI CONTROLS"
  },
  "description":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI CONTROLS"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"csvfile"
  },
  "path":{
  "@type":"string",
  "@value":"/etc/graylog/nist_800_53_to_cui.csv"
  },
  "separator":{
  "@type":"string",
  "@value":","
  },
  "quotechar":{
  "@type":"string",
  "@value":"\""
  },
  "key_column":{
  "@type":"string",
  "@value":"nist_800_53"
  },
  "value_column":{
  "@type":"string",
  "@value":"cui"
  },
  "check_interval":{
  "@type":"long",
  "@value":60
  },
  "case_insensitive_lookup":{
  "@type":"boolean",
  "@value":false
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"afea6f49-d8fb-4dab-90a1-e75fca6eb165",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"EPSS CVE Criticality - NMAP"
  },
  "description":{
  "@type":"string",
  "@value":"EPSS CVE Criticality - NMAP"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"EPSS CVE Criticality - NMAP\"\nwhen\n $message.rule_group3 == \"network_scan\"\nthen\n let ldata = lookup(\n lookup_table: \"epss\",\n key: to_string($message.data_nmap_port_cve_id)\n );\n set_fields(\n fields: ldata,\n prefix: \"epss_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"4275496b-5023-412c-81b5-e292dc857b1b",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_eventdata_initiated == \"true\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"protocol\", $message.data_eventdata_protocol);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"dst_ip\", $message.data_eventdata_DestinationIp);\n set_field(\"dst_port\", $message.data_eventdata_destinationPort);\n set_field(\"src_ip\", $message.data_eventdata_sourceIp);\n set_field(\"src_port\", $message.data_eventdata_sourcePort);\n set_field(\"traffic_direction\", \"external\"); \nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"b375a84d-a9b4-4794-814c-2e6339f78c6b",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OpenAudit Remove field - data_system_network_item_dhcp_lease_obtained"
  },
  "description":{
  "@type":"string",
  "@value":"OpenAudit Remove field - data_system_network_item_dhcp_lease_obtained"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OpenAudit Remove field - data_system_network_item_dhcp_lease_obtained\"\nwhen\n // Apply the rule when the specified field is present\n has_field(\"data_system_network_item_dhcp_lease_obtained\")\nthen\n // Remove the specified field\n remove_field(\"data_system_network_item_dhcp_lease_obtained\");\nend\n"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"3c265590-2c8c-4c76-8942-995f5e887df7",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSQUERY PROCESSES HASH NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"OSQUERY PROCESSES HASH NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSQUERY PROCESSES HASH NORMALIZATION\"\nwhen\n $message.data_osquery_name == \"processes_hash\"\nthen\n set_field(\"process_image\", $message.data_osquery_columns_name);\n set_field(\"dll_hashes\", $message.data_osquery_columns_sha256);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"ea677035-6bf4-4365-9153-183d345adde0",
  "type":{
  "name":"pipeline",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WAZUH PROCESSING PIPELINES"
  },
  "description":{
  "@type":"string",
  "@value":"WAZUH PROCESSING PIPELINES"
  },
  "source":{
  "@type":"string",
  "@value":"pipeline \"WAZUH PROCESSING PIPELINES\"\nstage 0 match pass\nrule \"DROP OSQUERY SOCKET EVENTS - WELL KNOWN PROCESSES\"\nrule \"DROP OSQUERY PROCESS EVENTS - WELL KNOWN PROCESSES\"\nrule \"DROP SYSMON EVT 7 LOGS - WELL KNOWN PROCESS IMAGE\"\nrule \"DROP SYSMON EVT 12 LOGS - WELL KNOWN PROCESS IMAGE\"\nrule \"DROP SYSMON EVT 10 LOGS - WELL KNOWN SOURCE PROCESS IMAGE\"\nrule \"DROP SYSMON EVT 13 LOGS - WELL KNOWN PROCESS IMAGE\"\nstage 1 match either\nrule \"WAZUH CREATE FIELD SYSLOG LEVEL - NOTICE\"\nrule \"WAZUH CREATE FIELD SYSLOG LEVEL - WARNING\"\nrule \"WAZUH CREATE FIELD SYSLOG LEVEL - INFO\"\nrule \"WAZUH CREATE FIELD SYSLOG LEVEL - ALERT\"\nrule \"Linux Sysmon Timestamp - UTC\"\nrule \"Office365 Timestamp - UTC\"\nrule \"Osquery Epoch Timestamp - UTC\"\nrule \"Packetbeat Timestamp - UTC\"\nrule \"Windows Timestamp - UTC\"\nrule \"URL Encode data_name field for ASK SOCFortress API\"\nrule \"NIST 800-53 TO CUI MAPPING\"\nstage 2 match pass\nrule \"USER ADDED TO PRIVILEGE ADMIN GROUP\"\nrule \"ASK SOCFORTRESS WINDOWS - CHAINSAW\"\nstage 3 match either\nrule \"LINUX SYSMON EVENT 1 LOG NORMALIZATION\"\nrule \"LINUX SYSMON EVENT 5 LOG NORMALIZATION\"\nrule \"LINUX SYSMON EVENT 9 LOG NORMALIZATION\"\nrule \"LINUX SYSMON EVENT 11 LOG NORMALIZATION\"\nrule \"LINUX SYSMON EVENT 23 LOG NORMALIZATION\"\nrule \"LINUX PACKETBEAT DNS LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 1 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 11 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 2 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 22 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 23 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 5 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 9 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 7 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 10 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 12 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 13 LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 17 LOG NORMALIZATION\"\nrule \"LINUX OSQUERY PROCESS LIST LOG NORMALIZATION\"\nrule \"LINUX PACKETBEAT NETWORK LOG NORMALIZATION\"\nrule \"LINUX SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION\"\nrule \"LINUX SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION\"\nrule \"WINDOWS SYSMON EVENT 15 LOG NORMALIZATION\"\nrule \"OSSEC SYSCHECK ADDED EVENT NORMALIZATION\"\nrule \"EPSS CVE Criticality\"\nrule \"EPSS CVE Criticality - NMAP\"\nrule \"WINDOWS PROCESS ID - No EventData Field\"\nrule \"WINDOWS PROCESS ID - Non SOCFortress Sysmon\"\nrule \"Timestamp Failsafe - UTC\"\nrule \"LINUX OSQUERY-BPF PROCESS LIST LOG NORMALIZATION\"\nrule \"WINDOWS PROCESS ID - SIGMA - data_system_Execution_attributes_ProcessID\"\nrule \"WINDOWS PROCESS ID - SIGMA - data_event_ProcessId\"\nrule \"WINDOWS PROCESS ID - SIGMA - data_event_SourceProcessId\"\nrule \"LINUX OSQUERY PROCESS ID - GENERIC\"\nrule \"MacOS OSQUERY PROCESS_EVENTS LOG NORMALIZATION\"\nrule \"OpenAudit Remove field - data_system_network_item_dhcp_lease_obtained\"\nrule \"OpenAudit Remove field - data_system_software_item_install_date\"\nstage 4 match pass\nrule \"WINDOWS SYSMON EVENT 1 - SOFTWARE VENDORS\"\nrule \"WINDOWS SYSMON EVENT 1 - EMPTY SOFTWARE VENDORS\"\nrule \"WINDOWS SYSMON EVENT 7 - SOFTWARE VENDORS\"\nrule \"WINDOWS SYSMON EVENT 7 - EMPTY SOFTWARE VENDORS\"\nrule \"WINDOWS SYSMON EVENT 3 - NETWORK PORTS\"\nstage 5 match pass\nrule \"WINDOWS SYSMON EVENT 1 - UNAPPROVED SOFTWARE VENDORS\"\nrule \"WINDOWS SYSMON EVENT 7 - UNAPPROVED SOFTWARE VENDORS\"\nrule \"WINDOWS SYSMON EVENT 3 - UNCOMMON PORT\"\nstage 7 match either\nrule \"OVERRIDE SYSLOG LEVEL AFTER IoC FOUND\"\nstage 6 match either\nrule \"LINUX SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL\"\nrule \"OSSEC SYSCHECK ADDED - SOCFORTRESS THREAT INTEL\"\nrule \"PACKETBEAT DNS QUERY - SOCFORTRESS THREAT INTEL\"\nrule \"PACKETBEAT HTTP/S CONNECTION - SOCFORTRESS THREAT INTEL\"\nrule \"WINDOWS SYSMON EVENT 1 - SOCFORTRESS THREAT INTEL\"\nrule \"WINDOWS SYSMON EVENT 15 - SOCFORTRESS THREAT INTEL\"\nrule \"WINDOWS SYSMON EVENT 22 - SOCFORTRESS THREAT INTEL\"\nrule \"WINDOWS SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL\"\nrule \"WINDOWS SYSMON EVENT 6 - SOCFORTRESS THREAT INTEL\"\nrule \"WINDOWS SYSMON EVENT 7 - SOCFORTRESS THREAT INTEL\"\nend"
  },
  "connected_streams":[
  {
  "@type":"string",
  "@value":"4d9017e0-3943-4382-8978-adbc45bbe5cb"
  },
  {
  "@type":"string",
  "@value":"7327e565-c8d6-4c5e-8aca-f4950040863e"
  },
  {
  "@type":"string",
  "@value":"deec9ffd-b8c2-4b2b-a2a0-6c4556b8f0a6"
  },
  {
  "@type":"string",
  "@value":"25cf5186-343d-43e6-acea-2e690e0c7f55"
  }
  ]
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"0f89bded-1cae-41ad-a5f1-0c4bf5a89e3a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"ASK SOCFORTRESS WINDOWS - CHAINSAW"
  },
  "description":{
  "@type":"string",
  "@value":"ASK SOCFORTRESS WINDOWS - CHAINSAW"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"ASK SOCFORTRESS WINDOWS - CHAINSAW\"\nwhen\n has_field(\"sigma_name_encoded\")\nthen\n let ask_socfortress = to_string($message.sigma_name_encoded);\n let ldata = lookup_value(\"ask_socfortress_windows\", ask_socfortress);\n set_field(\"ask_socfortress_message\", ldata);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e6adde8e-6719-4ec7-a7c0-5d191b2025e7",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 7 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event7\" AND $message.data_win_eventdata_signed == \"false\"\nthen\n let sha256_and_ampersand = concat(to_string($message.sha256), \"&customer_code=\");\n let new_key = concat(sha256_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"9036539c-49dc-4f19-b4fe-27b22079d6fc",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 9 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 9 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 9 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event9\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"device\", $message.data_eventdata_device);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e1d3ea11-4569-451c-ae55-fcde49c04e76",
  "type":{
  "name":"lookup_table",
  "version":"1"
  },
  "v":"1",
  "data":{
  "default_single_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "cache_name":{
  "@type":"string",
  "@value":"61146e00-b60c-4d11-8722-f0e36f5bb632"
  },
  "name":{
  "@type":"string",
  "@value":"software-vendors"
  },
  "default_multi_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "default_multi_value":{
  "@type":"string",
  "@value":""
  },
  "data_adapter_name":{
  "@type":"string",
  "@value":"d233aa15-9412-4f2e-85ab-66ebd4a760ad"
  },
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "title":{
  "@type":"string",
  "@value":"Software Vendors"
  },
  "default_single_value":{
  "@type":"string",
  "@value":""
  },
  "description":{
  "@type":"string",
  "@value":"Lookup table for Software Vendors"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"57e14807-2fc2-4b2e-acf1-46b39a8c9ff1",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 6 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 6 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 6 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event6\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_hash\",\n key: to_string($message.sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"5157960a-054d-42ee-b794-815fd1741c84",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"MacOS OSQUERY PROCESS_EVENTS LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"MacOS OSQUERY PROCESS_EVENTS LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"MacOS OSQUERY PROCESS_EVENTS LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"osquery\" AND $message.rule_group2 == \"process_events\"\nthen\n set_field(\"process_name\", $message.data_columns_path);\n set_field(\"process_image\", $message.data_columns_path);\n set_field(\"process_id\", $message.data_columns_pid);\n set_field(\"user_name\", $message.data_columns_username);\n set_field(\"software_vendor\", $message.data_columns_signing_id);\n set_field(\"software_product\", $message.data_columns_signing_id);\n set_field(\"process_image_hashes\", $message.data_columns_cdhash);\n set_field(\"parent_process_id\", $message.data_columns_parent);\n set_field(\"parent_process_image\", $message.data_columns_parent);\n set_field(\"parent_process_user\", $message.data_win_eventdata_parentUser);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"b472be12-e220-430b-a7be-2740f5571303",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 15 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 15 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 15 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_15\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"target_file\", $message.data_win_eventdata_targetFilename);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"352137e0-4944-4243-8703-da719dee0a5d",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - No EventData Field"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - No EventData Field"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS PROCESS ID - No EventData Field\"\nwhen\n ! has_field(\"data_win_eventdata_processId\") AND $message.rule_group1 == \"windows\"\nthen\n set_field(\"process_id\", $message.data_win_system_processID);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"c51c74cd-1de1-46eb-abe6-1c81b3973b7e",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 5 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 5 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 5 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event5\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"user_name\", $message.data_eventdata_user);\nend\n"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"ce72d2dd-76a9-4d77-a742-57cb7df77973",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - Non SOCFortress Sysmon"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - Non SOCFortress Sysmon"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS PROCESS ID - Non SOCFortress Sysmon\"\nwhen\n $message.rule_group1 != \"windows\" AND has_field(\"data_win_eventdata_processId\")\nthen\n set_field(\"process_id\", $message.data_win_eventdata_processId);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"007173d0-d5d3-4274-a8e1-7f225a5f1307",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 9 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 9 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 9 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event9\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"device\", $message.data_win_eventdata_device);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"a5a7b4ec-65a9-4fd5-a2fb-f0d50899e95e",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 1 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 1 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 1 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event1\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"process_cmd_line\", $message.data_eventdata_commandLine);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"parent_process_image\", $message.data_eventdata_parentImage);\n set_field(\"parent_cmd_line\", $message.data_eventdata_parentCommandLine);\n set_field(\"parent_process_id\", $message.data_eventdata_parentProcessId);\n set_field(\"parent_process_user\", $message.data_eventdata_parentUser);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"aa4e3e50-77d9-48b3-9685-76abbf16ca43",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX OSQUERY-BPF PROCESS LIST LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX OSQUERY-BPF PROCESS LIST LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX OSQUERY-BPF PROCESS LIST LOG NORMALIZATION\"\nwhen\n$message.rule_group1 == \"osquery\" AND ($message.rule_group2 == \"bpf_process_events\" OR $message.rule_group2 == \"list_processes_with_hash\")\nthen\n set_field(\"process_name\", $message.data_columns_path);\n set_field(\"process_image\", $message.data_columns_path);\n set_field(\"process_id\", $message.data_columns_pid);\n set_field(\"process_cmd_line\", $message.data_columns_cmdline);\n set_field(\"parent_process_id\", $message.data_columns_parent);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"31900dfc-b8ce-46bf-abab-d2db352be7e2",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_eventdata_DestinationIp != \"127.0.0.1\" AND $message.data_eventdata_DestinationIp != \"255.255.255.255\" AND $message.data_eventdata_DestinationIp != \"0.0.0.0\" AND $message.data_eventdata_destinationIsIpv6 == \"false\" AND ! in_private_net(to_string($message.data_eventdata_DestinationIp))\nthen\n let ip_and_ampersand = concat(to_string($message.data_eventdata_DestinationIp), \"&customer_code=\");\n let new_key = concat(ip_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"143d891a-a957-40fd-9834-af45ddc3a439",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"DROP OSQUERY SOCKET EVENTS - WELL KNOWN PROCESSES"
  },
  "description":{
  "@type":"string",
  "@value":"DROP OSQUERY SOCKET EVENTS - WELL KNOWN PROCESSES"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"DROP OSQUERY SOCKET EVENTS - WELL KNOWN PROCESSES\"\nwhen\n$message.rule_group2 == \"bpf_socket_events\" AND ($message.data_columns_path == \"/var/ossec/bin/wazuh-syscheckd\" OR $message.data_columns_path == \"/usr/bin/telegraf\" OR $message.data_columns_path == \"/usr/sbin/haproxy\" OR $message.data_columns_path == \"/var/ossec/bin/wazuh-control\" OR $message.data_columns_path == \"/opt/fluent-bit/bin/fluent-bit\" OR $message.data_columns_path == \"/var/ossec/framework/python/bin/python3.9\" OR $message.data_columns_path == \"/var/ossec/bin/wazuh-remoted\" OR $message.data_columns_path == \"/usr/share/filebeat/bin/filebeat\" OR $message.data_columns_path == \"/var/ossec/bin/wazuh-modulesd\" OR $message.data_columns_path == \"/worker\" OR $message.data_columns_path == \"/usr/bin/python3.9\" OR $message.data_columns_path == \"/usr/local/bin/python3.10\" OR $message.data_columns_path == \"/usr/local/sbin/haproxy\" OR $message.data_columns_path == \"/usr/bin/systemctl\" OR $message.data_columns_path == \"/usr/local/bin/python3.9\" OR $message.data_columns_path == \"/app/webapp\" OR $message.data_columns_path == \"/usr/share/graylog-server/jvm/bin/java\" OR $message.data_columns_path == \"/usr/share/grafana/bin/grafana\" OR $message.data_columns_path == \"/usr/bin/dockerd\" OR $message.data_columns_path == \"/usr/local/bin/velociraptor.bin\")\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"8f9f8583-1276-429a-ad1b-55ce0f3f92be",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 23 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 23 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 23 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_23\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"target_file\", $message.data_win_eventdata_targetFilename);\n set_field(\"is_executable\", $message.data_win_eventdata_isExecutable);\n set_field(\"file_hashes\", $message.data_win_eventdata_hashes);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"07340722-171e-482b-a678-772cb152d584",
  "type":{
  "name":"lookup_adapter",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"socfortress-threat-intel"
  },
  "title":{
  "@type":"string",
  "@value":"SOCFortress Threat Intel"
  },
  "description":{
  "@type":"string",
  "@value":"SOCFortress Threat Intel"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"httpjsonpath"
  },
  "url":{
  "@type":"string",
  "@value":"https://intel.socfortress.co/search?value=${key}"
  },
  "single_value_jsonpath":{
  "@type":"string",
  "@value":"$.success"
  },
  "multi_value_jsonpath":{
  "@type":"string",
  "@value":"$.data"
  },
  "user_agent":{
  "@type":"string",
  "@value":"curl/7.74.0"
  },
  "headers":{
  "Content-Type":{
  "@type":"string",
  "@value":"application/json"
  },
  "module-version":{
  "@type":"string",
  "@value":"1.0"
  },
  "x-api-key":{
  "@type":"string",
  "@value":"3cQRgzjZ8t9HA7dydpBc914ohhABBHwC2LKhLccx"
  }
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"9fad9c87-063a-42fe-8eee-1d4a14d33985",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 22 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 22 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 22 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_22\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"dns_query\", $message.data_win_eventdata_queryName);\n set_field(\"dns_answer\", $message.data_win_eventdata_queryResults);\n set_field(\"dns_response_code\", $message.data_win_eventdata_queryStatus);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"498bdbfc-695f-4811-beb9-1e6eacde1712",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSQUERY LIST NETWORK CONNECTION - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"OSQUERY LIST NETWORK CONNECTION - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSQUERY LIST NETWORK CONNECTION - OPENCTI THREAT INTEL\"\nwhen\n $message.data_osquery_name == \"list_network_connection\" AND $message.data_osquery_columns_remote_address != \"127.0.0.1\" AND $message.data_osquery_columns_remote_address != \"255.255.255.255\" AND $message.data_osquery_columns_remote_address != \"0.0.0.0\" AND ! in_private_net(to_string($message.data_osquery_columns_remote_address)) AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_query\",\n key: to_string($message.data_osquery_columns_remote_address)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"46567b4d-6d61-403c-9101-6c5e4940e7c6",
  "type":{
  "name":"lookup_table",
  "version":"1"
  },
  "v":"1",
  "data":{
  "default_single_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "cache_name":{
  "@type":"string",
  "@value":"83eed16b-7d7b-4db8-b953-e469ca8abd3a"
  },
  "name":{
  "@type":"string",
  "@value":"nist_800_53_to_cui"
  },
  "default_multi_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "default_multi_value":{
  "@type":"string",
  "@value":""
  },
  "data_adapter_name":{
  "@type":"string",
  "@value":"786c5f3e-0435-4895-a13c-29f897f5878c"
  },
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "title":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI CONTROLS"
  },
  "default_single_value":{
  "@type":"string",
  "@value":""
  },
  "description":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI CONTROLS"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"d811d282-9d0b-4113-bad2-eae2cda0e078",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"protocol\", $message.data_win_eventdata_protocol);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"dst_ip\", $message.data_win_eventdata_destinationIp);\n set_field(\"dst_port\", $message.data_win_eventdata_destinationPort);\n set_field(\"src_ip\", $message.data_win_eventdata_sourceIp);\n set_field(\"src_port\", $message.data_win_eventdata_sourcePort);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"b65a7a69-d12e-40d1-acbd-528bcca44197",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"REMOVE TEAMS MessageCreatedNotification LOGS"
  },
  "description":{
  "@type":"string",
  "@value":"REMOVE TEAMS MessageCreatedNotification LOGS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"REMOVE TEAMS MessageCreatedNotification LOGS\"\nwhen\n $message.data_office365_Operation == \"MessageCreatedNotification\"\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"989d111b-7719-45f1-bef2-750feb74fbad",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OVERRIDE SYSLOG LEVEL AFTER IoC FOUND"
  },
  "description":{
  "@type":"string",
  "@value":"OVERRIDE SYSLOG LEVEL AFTER IoC FOUND"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OVERRIDE SYSLOG LEVEL AFTER IoC FOUND\"\nwhen\n has_field(\"threat_intel_value\")\nthen\n set_field(\"syslog_level\", \"ALERT\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"c817b83d-76a3-4c13-8fcd-9fc941663f9b",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_win_eventdata_initiated == \"false\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"protocol\", $message.data_win_eventdata_protocol);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"dst_ip\", $message.data_win_eventdata_destinationIp);\n set_field(\"dst_port\", $message.data_win_eventdata_destinationPort);\n set_field(\"src_ip\", $message.data_win_eventdata_sourceIp);\n set_field(\"src_port\", $message.data_win_eventdata_sourcePort);\n set_field(\"traffic_direction\", \"ingress\"); \nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"b0cf1742-786c-405b-a951-55b421925be9",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX PACKETBEAT NETWORK LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX PACKETBEAT NETWORK LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX PACKETBEAT NETWORK LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group2 == \"packetbeat\"\nthen\n set_field(\"protocol\", $message.data_network_transport);\n set_field(\"dst_ip\", $message.data_destination_ip);\n set_field(\"dst_port\", $message.data_destination_port);\n set_field(\"src_ip\", $message.data_source_ip);\n set_field(\"src_port\", $message.data_source_port);\n set_field(\"traffic_direction\", $message.data_network_direction); \n remove_field(\"$message.data_@metadata_beat\");\n remove_field(\"$message.data_@metadata_type\");\n remove_field(\"$message.data_@metadata_version\");\n remove_field(\"$message.data_agent_ephemeral_id\");\n remove_field(\"$message.data_host_architecture\");\n remove_field(\"$message.data_host_containerized\");\n remove_field(\"$message.data_host_hostname\");\n remove_field(\"$message.data_host_id\");\n remove_field(\"$message.data_host_ip\");\n remove_field(\"$message.data_host_mac\");\n remove_field(\"$message.data_host_name\");\n remove_field(\"$message.data_host_os_codename\");\n remove_field(\"$message.data_host_os_family\");\n remove_field(\"$message.data_host_os_kernel\");\n remove_field(\"$message.data_host_os_name\");\n remove_field(\"$message.data_host_os_platform\");\n remove_field(\"$message.data_host_os_type\");\n remove_field(\"$message.data_host_os_version\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"64cba889-bb7f-467c-ba9e-c13bf1e2dbe6",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 1 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event1\" AND ! has_field(\"misp_category\") AND ! has_field(\"data_win_eventdata_company\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_hash\",\n key: to_string($message.sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"3306b937-078a-48bc-a701-bc6f57589fae",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 1 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event1\" AND ! has_field(\"data_win_eventdata_company\")\nthen\n let sha256_and_ampersand = concat(to_string($message.sha256), \"&customer_code=\");\n let new_key = concat(sha256_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"f5660f76-aa62-44a7-97a2-8e02df8021c6",
  "type":{
  "name":"lookup_cache",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"epss-cache"
  },
  "title":{
  "@type":"string",
  "@value":"EPSS Cache"
  },
  "description":{
  "@type":"string",
  "@value":"EPSS Cache"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"guava_cache"
  },
  "max_size":{
  "@type":"integer",
  "@value":1000
  },
  "expire_after_access":{
  "@type":"long",
  "@value":60
  },
  "expire_after_access_unit":{
  "@type":"string",
  "@value":"MINUTES"
  },
  "expire_after_write":{
  "@type":"long",
  "@value":0
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"7327e565-c8d6-4c5e-8aca-f4950040863e",
  "type":{
  "name":"stream",
  "version":"1"
  },
  "v":"1",
  "data":{
  "alarm_callbacks":[
  ],
  "outputs":[
  ],
  "remove_matches":{
  "@type":"boolean",
  "@value":true
  },
  "title":{
  "@type":"string",
  "@value":"WAZUH EDR EVENTS"
  },
  "stream_rules":[
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"syslog_type"
  },
  "value":{
  "@type":"string",
  "@value":"wazuh"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"agent_labels_customer"
  },
  "value":{
  "@type":"string",
  "@value":"interhyve"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"rule_group1"
  },
  "value":{
  "@type":"string",
  "@value":"office365"
  },
  "inverted":{
  "@type":"boolean",
  "@value":true
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"rule_group1"
  },
  "value":{
  "@type":"string",
  "@value":"socfortress_healthcheck"
  },
  "inverted":{
  "@type":"boolean",
  "@value":true
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"rule_group1"
  },
  "value":{
  "@type":"string",
  "@value":"suricata"
  },
  "inverted":{
  "@type":"boolean",
  "@value":true
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  }
  ],
  "alert_conditions":[
  ],
  "matching_type":{
  "@type":"string",
  "@value":"AND"
  },
  "disabled":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":"INTERHYVE - WAZUH EDR EVENTS"
  },
  "default_stream":{
  "@type":"boolean",
  "@value":false
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"21d6ba9a-78c4-4d64-9f41-7e83d459f684",
  "type":{
  "name":"lookup_table",
  "version":"1"
  },
  "v":"1",
  "data":{
  "default_single_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "cache_name":{
  "@type":"string",
  "@value":"322a7f12-c4e9-4d8c-8f07-1bbc34375b16"
  },
  "name":{
  "@type":"string",
  "@value":"ask_socfortress_windows"
  },
  "default_multi_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "default_multi_value":{
  "@type":"string",
  "@value":""
  },
  "data_adapter_name":{
  "@type":"string",
  "@value":"3b94c0f2-4817-4ec9-90d4-d82712df8261"
  },
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "title":{
  "@type":"string",
  "@value":"ASK SOCFortress - Windows"
  },
  "default_single_value":{
  "@type":"string",
  "@value":""
  },
  "description":{
  "@type":"string",
  "@value":"ASK SOCFortress - Windows"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"16b60631-8268-4096-824c-63ee53c28db3",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 7 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event7\"\nthen\n set_field(\"dll_name\", $message.data_win_eventdata_originalFileName);\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"software_vendor\", $message.data_win_eventdata_company);\n set_field(\"image_loaded\", $message.data_win_eventdata_imageLoaded);\n set_field(\"dll_signature\", $message.data_win_eventdata_signature);\n set_field(\"dll_signed\", $message.data_win_eventdata_signed);\n set_field(\"dll_signature_status\", $message.data_win_eventdata_signatureStatus);\n set_field(\"dll_hashes\", $message.data_win_eventdata_hashes);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"6f1ab4d7-38bb-4a09-989c-ee84cbb11334",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSSEC SYSCHECK ADDED EVENT NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"OSSEC SYSCHECK ADDED EVENT NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSSEC SYSCHECK ADDED EVENT NORMALIZATION\"\nwhen\n $message.rule_group1 == \"ossec\" AND $message.rule_group2 == \"syscheck\" AND $message.syscheck_event == \"added\"\nthen\n set_field(\"sha256\", $message.syscheck_sha256_after);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"6d6b09ab-17d4-4725-a175-4606bcc47787",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_win_eventdata_destinationIp != \"127.0.0.1\" AND $message.data_win_eventdata_destinationIp != \"255.255.255.255\" AND $message.data_win_eventdata_destinationIp != \"0.0.0.0\" AND $message.data_win_eventdata_destinationIsIpv6 == \"false\" AND ! in_private_net(to_string($message.data_win_eventdata_destinationIp)) AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_query\",\n key: to_string($message.data_win_eventdata_destinationIp)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e5942eed-372f-40ff-bc79-81b08d224665",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSQUERY NETWORK CONNECTION LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"OSQUERY NETWORK CONNECTION LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSQUERY NETWORK CONNECTION LOG NORMALIZATION\"\nwhen\n $message.data_osquery_name == \"list_network_connection\"\nthen\n set_field(\"process_image\", $message.data_osquery_columns_name);\n set_field(\"process_id\", $message.data_osquery_columns_pid);\n set_field(\"protocol\", $message.data_osquery_columns_protocol);\n set_field(\"user_name\", $message.data_osquery_columns_username);\n set_field(\"dst_ip\", $message.data_osquery_columns_remote_address);\n set_field(\"dst_port\", $message.data_osquery_columns_remote_port);\n set_field(\"src_ip\", $message.data_osquery_columns_local_address);\n set_field(\"src_port\", $message.data_osquery_columns_local_port);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"89da65bb-1229-449b-b0a6-9dc2c04c5d4d",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - SIGMA - data_system_Execution_attributes_ProcessID"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - SIGMA - data_system_Execution_attributes_ProcessID"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS PROCESS ID - SIGMA - data_system_Execution_attributes_ProcessID\"\nwhen\n has_field(\"data_system_Execution_attributes_ProcessID\") AND $message.rule_group1 == \"windows\" AND $message.rule_group2 == \"chainsaw\"\nthen\n set_field(\"process_id\", $message.data_system_Execution_attributes_ProcessID);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"023901a9-37d0-4013-b72b-682d40ddf378",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 3 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event3\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_query\",\n key: to_string($message.data_eventdata_DestinationIp)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"d5f92978-1205-4211-9801-74308eeb0678",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSQUERY PROCESS HASH - MISP THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"OSQUERY PROCESS HASH - MISP THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSQUERY PROCESS HASH - MISP THREAT INTEL\"\nwhen\n $message.data_osquery_name == \"processes_hash\"\nthen\n let ldata = lookup(\n lookup_table: \"misp_query\",\n key: to_string($message.data_osquery_columns_sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"misp_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"1d3bfe98-3795-4a77-9158-2099fc2b645a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Threat Intelligence Lookups: src_ip"
  },
  "description":{
  "@type":"string",
  "@value":"Threat Intelligence Lookups: src_ip"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Threat Intelligence Lookups: src_ip\"\nwhen\nhas_field(\"src_ip\")\nthen\nset_fields(threat_intel_lookup_ip(to_string($message.src_ip), \"src_ip\"));\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"5e218655-3381-4aca-bf3e-af7d07ae525e",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 11 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 11 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 11 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event_11\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"target_file\", $message.data_eventdata_targetFilename);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"254c4773-9f1b-4d0b-a7b4-ebac0847f9e9",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 15 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 15 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 15 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_15\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_hash\",\n key: to_string($message.sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"a14fb67f-3ea0-4f5f-a758-edf57cb5fec2",
  "type":{
  "name":"lookup_table",
  "version":"1"
  },
  "v":"1",
  "data":{
  "default_single_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "cache_name":{
  "@type":"string",
  "@value":"f5660f76-aa62-44a7-97a2-8e02df8021c6"
  },
  "name":{
  "@type":"string",
  "@value":"epss"
  },
  "default_multi_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "default_multi_value":{
  "@type":"string",
  "@value":""
  },
  "data_adapter_name":{
  "@type":"string",
  "@value":"e8f784fc-da67-43b9-966f-ed7344f4a9f2"
  },
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "title":{
  "@type":"string",
  "@value":"EPSS Lookup Table"
  },
  "default_single_value":{
  "@type":"string",
  "@value":""
  },
  "description":{
  "@type":"string",
  "@value":"https://www.first.org/epss/api"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"dec5eab2-f5e8-4bb2-bf6d-be8383988c97",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 7 LOGS - WELL KNOWN PROCESS IMAGE"
  },
  "description":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 7 LOGS - WELL KNOWN PROCESS IMAGE"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"DROP SYSMON EVT 7 LOGS - WELL KNOWN PROCESS IMAGE\"\nwhen\n$message.rule_group3 == \"sysmon_event7\" AND \n($message.data_win_eventdata_image == \"C:\\\\\\\\Program Files\\\\\\\\ATERA Networks\\\\\\\\AteraAgent\\\\\\\\Packages\\\\\\\\AgentPackageHeartbeat\\\\\\\\AgentPackageHeartbeat.exe\" \nOR $message.data_win_eventdata_image == \"C:\\\\\\\\Program Files\\\\\\\\ATERA Networks\\\\\\\\AteraAgent\\\\\\\\Packages\\\\\\\\AgentPackageSTRemote\\\\\\\\AgentPackageSTRemote.exe\" \nOR $message.data_win_eventdata_image == \"C:\\\\\\\\Program Files\\\\\\\\ATERA Networks\\\\\\\\AteraAgent\\\\\\\\Packages\\\\\\\\AgentPackageMonitoring\\\\\\\\AgentPackageMonitoring.exe\" \nOR $message.data_win_eventdata_image == \"C:\\\\\\\\Program Files\\\\\\\\ATERA Networks\\\\\\\\AteraAgent\\\\\\\\Packages\\\\\\\\AgentPackageInternalPoller\\\\\\\\AgentPackageInternalPoller.exe\")\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"20e9d5f2-7512-4c07-baa7-bca1ff2d0b69",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - SIGMA - data_event_SourceProcessId"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - SIGMA - data_event_SourceProcessId"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS PROCESS ID - SIGMA - data_event_SourceProcessId\"\nwhen\n has_field(\"data_event_SourceProcessId\") AND $message.rule_group1 == \"windows\" AND $message.rule_group2 == \"chainsaw\"\nthen\n set_field(\"process_id\", $message.data_event_SourceProcessId);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"7a921cb6-3bbd-456b-803d-9fe3c98cc093",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 13 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 13 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 13 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_13\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"target_object\", $message.data_win_eventdata_targetObject);\n set_field(\"event_type\", $message.data_win_eventdata_eventType);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"da1c50a7-6d10-4ceb-a574-d5483546cafb",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"DROP OSQUERY PROCESS EVENTS - WELL KNOWN PROCESSES"
  },
  "description":{
  "@type":"string",
  "@value":"DROP OSQUERY PROCESS EVENTS - WELL KNOWN PROCESSES"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"DROP OSQUERY PROCESS EVENTS - WELL KNOWN PROCESSES\"\nwhen\n$message.rule_group2 == \"process_events\" AND ($message.data_columns_path == \"/usr/bin/ls\" OR $message.data_columns_path == \"/usr/bin/ps\" OR $message.data_columns_path == \"/usr/bin/sleep\" OR $message.data_columns_path == \"/usr/bin/awk\" OR $message.data_columns_path == \"/var/ossec/bin/wazuh-control\" OR $message.data_columns_path == \"/usr/bin/runc\" OR $message.data_columns_path == \"/usr/libexec/docker/docker-init\")\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"db157545-73d7-4b46-a1a9-1ca84633400a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"URL Encode data_name field for ASK SOCFortress API"
  },
  "description":{
  "@type":"string",
  "@value":"URL Encode `data_name` field for ASK SOCFortress API"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"URL Encode data_name field for ASK SOCFortress API\"\nwhen\n has_field(\"data_name\") AND $message.rule_group2 == \"chainsaw\" AND $message.data_logsource_product == \"windows\"\nthen\n let replaced = replace(to_string($message.data_name), \" \", \"%20\");\n set_field(\"sigma_name_encoded\", replaced);\nend\n"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e89644c3-7066-43dc-be90-d76c5b62494b",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX OSQUERY PROCESS ID - GENERIC"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX OSQUERY PROCESS ID - GENERIC"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX OSQUERY PROCESS ID - GENERIC\"\nwhen\n$message.rule_group1 == \"osquery\"\nthen\n set_field(\"process_id\", $message.data_columns_pid);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"d233aa15-9412-4f2e-85ab-66ebd4a760ad",
  "type":{
  "name":"lookup_adapter",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"software-vendors"
  },
  "title":{
  "@type":"string",
  "@value":"Software Vendors"
  },
  "description":{
  "@type":"string",
  "@value":"List of Approved Software Vendors"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"csvfile"
  },
  "path":{
  "@type":"string",
  "@value":"/etc/graylog/software_vendors.csv"
  },
  "separator":{
  "@type":"string",
  "@value":","
  },
  "quotechar":{
  "@type":"string",
  "@value":"\""
  },
  "key_column":{
  "@type":"string",
  "@value":"vendor"
  },
  "value_column":{
  "@type":"string",
  "@value":"approved"
  },
  "check_interval":{
  "@type":"long",
  "@value":60
  },
  "case_insensitive_lookup":{
  "@type":"boolean",
  "@value":true
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"27ddebcd-85a9-48bd-b111-2560736281b1",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 12 LOGS - WELL KNOWN PROCESS IMAGE"
  },
  "description":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 12 LOGS - WELL KNOWN PROCESS IMAGE"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"DROP SYSMON EVT 12 LOGS - WELL KNOWN PROCESS IMAGE\"\nwhen\n$message.rule_group3 == \"sysmon_event_12\" AND ($message.data_win_eventdata_image == \"C:\\\\\\\\Program Files\\\\\\\\ATERA Networks\\\\\\\\AteraAgent\\\\\\\\Packages\\\\\\\\AgentPackageHeartbeat\\\\\\\\AgentPackageHeartbeat.exe\" OR $message.data_win_eventdata_image == \"C:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\svchost.exe\" OR $message.data_win_eventdata_image == \"C:\\\\\\\\windows\\\\\\\\system32\\\\\\\\svchost.exe\" OR $message.data_win_eventdata_image == \"C:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\svchost.exe\")\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"26cd6f6b-5b8e-4f4c-8e35-3703f2505786",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 11 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 11 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 11 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_11\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"target_file\", $message.data_win_eventdata_targetFilename);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"ab55ffc7-e1b3-490e-9fa3-4b321605ec7b",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - UNAPPROVED SOFTWARE VENDORS"
  },
  "description":{
  "@type":"string",
  "@value":""
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 7 - UNAPPROVED SOFTWARE VENDORS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event7\" AND ! has_field(\"software_approved\")\nthen\nset_field(\"software_approved\", \"no\");\nlet build_message_0 = to_string(\" Sysmon - Event 7: Image Loaded by Unapproved Software \");\nlet build_message_1 = concat(build_message_0, to_string($message.data_win_eventdata_company));\nset_field(\"rule_description\", build_message_1);\nset_field(\"syslog_level\", \"WARNING\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"6edad355-38e5-4e12-8993-4076958d40a6",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 3 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event3\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"protocol\", $message.data_eventdata_protocol);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"dst_ip\", $message.data_eventdata_DestinationIp);\n set_field(\"dst_port\", $message.data_eventdata_destinationPort);\n set_field(\"src_ip\", $message.data_eventdata_sourceIp);\n set_field(\"src_port\", $message.data_eventdata_sourcePort);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"308824af-a30c-4afb-a1fd-3daa38d4b612",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 2 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 2 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 2 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event2\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"target_file\", $message.data_win_eventdata_targetFilename);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"24aef190-718d-4cd2-809f-14e799567486",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"USER ADDED TO PRIVILEGE ADMIN GROUP"
  },
  "description":{
  "@type":"string",
  "@value":"USER ADDED TO PRIVILEGE ADMIN GROUP"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"USER ADDED TO PRIVILEGE ADMIN GROUP\"\nwhen\n $message.data_win_system_eventID == \"4728\" OR $message.data_win_system_eventID == \"4732\" OR $message.data_win_system_eventID == \"4756\"\nthen\n let ldata = lookup_value(\n lookup_table: \"ad-admin-groups\",\n key: to_string($message.data_win_eventdata_targetUserName)\n );\n set_field(\"is_admin_group\", ldata);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"2c7d9684-488b-4aea-b68e-8d3a2fa33a4c",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - SOFTWARE VENDORS"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - SOFTWARE VENDORS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 7 - SOFTWARE VENDORS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event7\" AND has_field(\"data_win_eventdata_company\")\nthen\n let ldata = lookup_value(\n lookup_table: \"software-vendors\",\n key: to_string($message.data_win_eventdata_company,\"no\")\n );\n set_field(\"software_approved\", ldata);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"9dcd9ddb-ea99-4c49-b313-090fbfd74236",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI MAPPING"
  },
  "description":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI MAPPING"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"NIST 800-53 TO CUI MAPPING\"\nwhen\n has_field(\"rule_nist_800_53\")\nthen\n let ldata = lookup(\n lookup_table: \"nist_800_53_to_cui\",\n key: to_string($message.rule_nist_800_53)\n );\n set_fields(\n fields: ldata,\n prefix: \"cui_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e5f8dd6f-16bf-412c-8da7-11ec351585c8",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"MISP IoCs LOOKUP - DST IP"
  },
  "description":{
  "@type":"string",
  "@value":"MISP IoCs LOOKUP - DST IP"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"MISP IoCs LOOKUP - DST IP\"\nwhen\n has_field(\"dst_ip\") && $message.dst_ip != \"127.0.0.1\" && $message.dst_ip != \"255.255.255.255\" && ! in_private_net(to_string($message.dst_ip))\nthen\n let ldata = lookup(\n lookup_table: \"misp_query\",\n key: to_string($message.dst_ip)\n );\n set_fields(\n fields: ldata,\n prefix: \"misp_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"002c6425-6107-44ac-b5ea-acf79aa1e241",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Packetbeat Timestamp - UTC"
  },
  "description":{
  "@type":"string",
  "@value":"Packetbeat Timestamp - UTC"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Packetbeat Timestamp - UTC\"\nwhen\n has_field(\"data_event_start\")\nthen\n let time = parse_date(to_string($message.data_event_start), \"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS'Z'\", \"Etc/UTC\");\n set_field(\"timestamp_utc\", time);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"ec6dba68-99ee-407c-9a4f-4495a4f585b4",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 5 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 5 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 5 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event5\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"user_name\", $message.data_win_eventdata_user);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"aaeae71a-7eb6-48dc-b562-24cdc6de1115",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - UNAPPROVED SOFTWARE VENDORS"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - UNAPPROVED SOFTWARE VENDORS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 1 - UNAPPROVED SOFTWARE VENDORS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event1\" AND ! has_field(\"software_approved\")\nthen\nset_field(\"software_approved\", \"no\");\nset_field(\"syslog_level\", \"WARNING\");\nlet build_message_0 = to_string(\" Sysmon - Event 1: Process creation Unapproved Software \");\nlet build_message_1 = concat(build_message_0, to_string($message.data_win_eventdata_company));\nset_field(\"rule_description\", build_message_1);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"59ed1a98-7c79-4d61-86ff-a427304916d5",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"PACKETBEAT DNS QUERY - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"PACKETBEAT DNS QUERY - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"PACKETBEAT DNS QUERY - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"dns\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_query\",\n key: to_string($message.data_dns_question_name)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"6ef95af4-0587-4d42-b6d7-757ad741ef23",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"PACKETBEAT HTTP/S CONNECTION - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"PACKETBEAT HTTP/S CONNECTION - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"PACKETBEAT HTTP/S CONNECTION - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"tls\" OR $message.rule_group3 == \"http\"\nthen\n let ip_and_ampersand = concat(to_string($message.data_destination_ip), \"&customer_code=\");\n let new_key = concat(ip_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"187f6da8-71f1-49f9-a6bd-dbc53ea0b829",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 22 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 22 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 22 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_22\"\nthen\n let query_name_and_ampersand = concat(to_string($message.data_win_eventdata_queryName), \"&customer_code=\");\n let new_key = concat(query_name_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"d6be9b6c-3b4d-4fdf-b5b0-ae6b24f1cc8c",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 23 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 23 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 23 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event_23\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"target_file\", $message.data_eventdata_targetFilename);\n set_field(\"is_executable\", $message.data_eventdata_isExecutable);\n set_field(\"file_hashes\", $message.data_eventdata_hashes);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"3e63a276-c5bd-4c82-83ce-b8bc113192d0",
  "type":{
  "name":"lookup_table",
  "version":"1"
  },
  "v":"1",
  "data":{
  "default_single_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "cache_name":{
  "@type":"string",
  "@value":"86437950-7bf9-4922-bf1a-831c34a8a103"
  },
  "name":{
  "@type":"string",
  "@value":"network-ports"
  },
  "default_multi_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "default_multi_value":{
  "@type":"string",
  "@value":""
  },
  "data_adapter_name":{
  "@type":"string",
  "@value":"e5e5dbbe-9e08-4a23-ad79-a271588d73c5"
  },
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "title":{
  "@type":"string",
  "@value":"Network Ports"
  },
  "default_single_value":{
  "@type":"string",
  "@value":""
  },
  "description":{
  "@type":"string",
  "@value":"Lookup table for network ports"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"b00c2f4b-960c-457b-b655-6f7b9aa19948",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WAZUH CREATE FIELD SYSLOG LEVEL - INFO"
  },
  "description":{
  "@type":"string",
  "@value":"WAZUH CREATE FIELD SYSLOG LEVEL - INFO"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WAZUH CREATE FIELD SYSLOG LEVEL - INFO\"\nwhen to_long($message.rule_level) > 0 AND to_long($message.rule_level) < 4\nthen\nset_field(\"syslog_level\", \"INFO\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"4126e05b-f218-46f9-829b-e59bb298a52c",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 OUTBOUND CONNECTION LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_win_eventdata_initiated == \"true\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"protocol\", $message.data_win_eventdata_protocol);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"dst_ip\", $message.data_win_eventdata_destinationIp);\n set_field(\"dst_port\", $message.data_win_eventdata_destinationPort);\n set_field(\"src_ip\", $message.data_win_eventdata_sourceIp);\n set_field(\"src_port\", $message.data_win_eventdata_sourcePort);\n set_field(\"traffic_direction\", \"external\"); \nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e5e5dbbe-9e08-4a23-ad79-a271588d73c5",
  "type":{
  "name":"lookup_adapter",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"network-ports"
  },
  "title":{
  "@type":"string",
  "@value":"Network Ports"
  },
  "description":{
  "@type":"string",
  "@value":"List of Common Network Ports"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"csvfile"
  },
  "path":{
  "@type":"string",
  "@value":"/etc/graylog/network_ports.csv"
  },
  "separator":{
  "@type":"string",
  "@value":","
  },
  "quotechar":{
  "@type":"string",
  "@value":"\""
  },
  "key_column":{
  "@type":"string",
  "@value":"port"
  },
  "value_column":{
  "@type":"string",
  "@value":"common"
  },
  "check_interval":{
  "@type":"long",
  "@value":60
  },
  "case_insensitive_lookup":{
  "@type":"boolean",
  "@value":true
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"28091b1b-d74d-4e6e-a7ef-ec9e4fbf8eee",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 13 LOGS - WELL KNOWN PROCESS IMAGE"
  },
  "description":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 13 LOGS - WELL KNOWN PROCESS IMAGE"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"DROP SYSMON EVT 13 LOGS - WELL KNOWN PROCESS IMAGE\"\nwhen\n$message.rule_group3 == \"sysmon_event_13\" AND ($message.data_win_eventdata_image == \"C:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\svchost.exe\" OR $message.data_win_eventdata_image == \"C:\\\\\\\\windows\\\\\\\\system32\\\\\\\\svchost.exe\" OR $message.data_win_eventdata_image == \"C:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\svchost.exe\" OR $message.data_win_eventdata_image == \"C:\\\\\\\\Program Files\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\")\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"0eeb458f-789a-4bac-8940-8d64fc783509",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSQUERY LIST NETWORK CONNECTION - MISP THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"OSQUERY LIST NETWORK CONNECTION - MISP THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSQUERY LIST NETWORK CONNECTION - MISP THREAT INTEL\"\nwhen\n $message.data_osquery_name == \"list_network_connection\" AND $message.data_osquery_columns_remote_address != \"127.0.0.1\" AND $message.data_osquery_columns_remote_address != \"255.255.255.255\" AND $message.data_osquery_columns_remote_address != \"0.0.0.0\" AND ! in_private_net(to_string($message.data_osquery_columns_remote_address))\nthen\n let ldata = lookup(\n lookup_table: \"misp_query\",\n key: to_string($message.data_osquery_columns_remote_address)\n );\n set_fields(\n fields: ldata,\n prefix: \"misp_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"78beecba-7726-4364-8863-5e2d3dc02726",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSSEC SYSCHECK ADDED - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"OSSEC SYSCHECK ADDED - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSSEC SYSCHECK ADDED - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"ossec\" AND $message.rule_group2 == \"syscheck\" AND $message.syscheck_event == \"added\"\nthen\n let sha256_and_ampersand = concat(to_string($message.sha256), \"&customer_code=\");\n let new_key = concat(sha256_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend\n"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"988722b8-31ee-46c0-a306-38db772e823d",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - UNCOMMON PORT"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - UNCOMMON PORT"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 - UNCOMMON PORT\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\" AND ! has_field(\"port_common\")\nthen\nset_field(\"port_common\", \"no\");\nset_field(\"syslog_level\", \"WARNING\");\nlet build_message_0 = to_string(\" Sysmon - Event 3: Network connection to Uncommon Port by \");\nlet build_message_1 = concat(build_message_0, to_string($message.data_win_eventdata_image));\nset_field(\"rule_description\", build_message_1);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"10b44e41-ae2e-449a-8849-bbd7c0bc189a",
  "type":{
  "name":"input",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WAZUH EVENTS FLUENT BIT - TCP"
  },
  "configuration":{
  "tls_key_file":{
  "@type":"string",
  "@value":"soc-syslog-manager"
  },
  "port":{
  "@type":"integer",
  "@value":5555
  },
  "tls_enable":{
  "@type":"boolean",
  "@value":false
  },
  "use_null_delimiter":{
  "@type":"boolean",
  "@value":false
  },
  "recv_buffer_size":{
  "@type":"integer",
  "@value":1048576
  },
  "tcp_keepalive":{
  "@type":"boolean",
  "@value":false
  },
  "tls_client_auth_cert_file":{
  "@type":"string",
  "@value":""
  },
  "bind_address":{
  "@type":"string",
  "@value":"0.0.0.0"
  },
  "tls_cert_file":{
  "@type":"string",
  "@value":""
  },
  "max_message_size":{
  "@type":"integer",
  "@value":2097152
  },
  "tls_client_auth":{
  "@type":"string",
  "@value":"disabled"
  },
  "number_worker_threads":{
  "@type":"integer",
  "@value":8
  },
  "tls_key_password":{
  "@type":"string",
  "@value":"na)R]Q`7q9>qxjqLdn-T[=sX"
  }
  },
  "static_fields":{
  "syslog_type":{
  "@type":"string",
  "@value":"wazuh"
  }
  },
  "type":{
  "@type":"string",
  "@value":"org.graylog2.inputs.raw.tcp.RawTCPInput"
  },
  "global":{
  "@type":"boolean",
  "@value":false
  },
  "extractors":[
  {
  "target_field":{
  "@type":"string",
  "@value":""
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":0
  },
  "converters":[
  ],
  "configuration":{
  "list_separator":{
  "@type":"string",
  "@value":", "
  },
  "kv_separator":{
  "@type":"string",
  "@value":":"
  },
  "key_prefix":{
  "@type":"string",
  "@value":""
  },
  "key_separator":{
  "@type":"string",
  "@value":"_"
  },
  "replace_key_whitespace":{
  "@type":"boolean",
  "@value":false
  },
  "key_whitespace_replacement":{
  "@type":"string",
  "@value":"_"
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"message"
  },
  "title":{
  "@type":"string",
  "@value":"FLUENTD - JSON EXTRACTOR"
  },
  "type":{
  "@type":"string",
  "@value":"JSON"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"hash_sha256"
  },
  "condition_value":{
  "@type":"string",
  "@value":"SHA256"
  },
  "order":{
  "@type":"integer",
  "@value":10
  },
  "converters":[
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":3
  },
  "split_by":{
  "@type":"string",
  "@value":","
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_hashes"
  },
  "title":{
  "@type":"string",
  "@value":"FILE HASHES 1 - SHA256"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"STRING"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"sha256"
  },
  "condition_value":{
  "@type":"string",
  "@value":"SHA256"
  },
  "order":{
  "@type":"integer",
  "@value":12
  },
  "converters":[
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":2
  },
  "split_by":{
  "@type":"string",
  "@value":"="
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"hash_sha256"
  },
  "title":{
  "@type":"string",
  "@value":"SHA256 FILE HASH EXTRACTOR"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"STRING"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"hash_sha256"
  },
  "condition_value":{
  "@type":"string",
  "@value":"SHA256"
  },
  "order":{
  "@type":"integer",
  "@value":11
  },
  "converters":[
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":3
  },
  "split_by":{
  "@type":"string",
  "@value":","
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_hash"
  },
  "title":{
  "@type":"string",
  "@value":"FILE HASHES 2 - SHA256"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"STRING"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"rule_group3"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":7
  },
  "converters":[
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":3
  },
  "split_by":{
  "@type":"string",
  "@value":","
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"rule_groups"
  },
  "title":{
  "@type":"string",
  "@value":"WAZUH RULE GROUPS SPLIT 3"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"rule_group2"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":6
  },
  "converters":[
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":2
  },
  "split_by":{
  "@type":"string",
  "@value":","
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"rule_groups"
  },
  "title":{
  "@type":"string",
  "@value":"WAZUH RULE GROUPS SPLIT 2"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"rule_group1"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":5
  },
  "converters":[
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":1
  },
  "split_by":{
  "@type":"string",
  "@value":","
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"rule_groups"
  },
  "title":{
  "@type":"string",
  "@value":"WAZUH RULE GROUPS SPLIT"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"powershell_host_version"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":2
  },
  "converters":[
  ],
  "configuration":{
  "regex_value":{
  "@type":"string",
  "@value":"HostVersion=(\\d+.\\d+.\\d+.\\d+)"
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_data"
  },
  "title":{
  "@type":"string",
  "@value":"Powershell Host Version"
  },
  "type":{
  "@type":"string",
  "@value":"REGEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"data_win_eventdata_rv_json"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":8
  },
  "converters":[
  ],
  "configuration":{
  "regex":{
  "@type":"string",
  "@value":"\\\\\\\""
  },
  "replacement":{
  "@type":"string",
  "@value":"\\\""
  },
  "replace_all":{
  "@type":"boolean",
  "@value":true
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_rv"
  },
  "title":{
  "@type":"string",
  "@value":"EXTRACT JSON FROM F-SECURE MESSAGE"
  },
  "type":{
  "@type":"string",
  "@value":"REGEX_REPLACE"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"CUT"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":""
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":13
  },
  "converters":[
  ],
  "configuration":{
  "list_separator":{
  "@type":"string",
  "@value":", "
  },
  "kv_separator":{
  "@type":"string",
  "@value":":"
  },
  "key_prefix":{
  "@type":"string",
  "@value":"misp_"
  },
  "key_separator":{
  "@type":"string",
  "@value":"_"
  },
  "replace_key_whitespace":{
  "@type":"boolean",
  "@value":false
  },
  "key_whitespace_replacement":{
  "@type":"string",
  "@value":"_"
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"misp_Event"
  },
  "title":{
  "@type":"string",
  "@value":"MISP EVENT JSON EXTRACTOR"
  },
  "type":{
  "@type":"string",
  "@value":"JSON"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":""
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":9
  },
  "converters":[
  ],
  "configuration":{
  "list_separator":{
  "@type":"string",
  "@value":", "
  },
  "kv_separator":{
  "@type":"string",
  "@value":":"
  },
  "key_prefix":{
  "@type":"string",
  "@value":""
  },
  "key_separator":{
  "@type":"string",
  "@value":"_"
  },
  "replace_key_whitespace":{
  "@type":"boolean",
  "@value":false
  },
  "key_whitespace_replacement":{
  "@type":"string",
  "@value":"_"
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_rv_json"
  },
  "title":{
  "@type":"string",
  "@value":"EXTRACT KEY VALUE PAIRS FROM JSON F-SECURE MESSAGE"
  },
  "type":{
  "@type":"string",
  "@value":"JSON"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"CUT"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"imphash"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":4
  },
  "converters":[
  {
  "type":{
  "@type":"string",
  "@value":"TOKENIZER"
  },
  "configuration":{
  }
  }
  ],
  "configuration":{
  "index":{
  "@type":"integer",
  "@value":4
  },
  "split_by":{
  "@type":"string",
  "@value":","
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_hash"
  },
  "title":{
  "@type":"string",
  "@value":"Extracted IMPHASH"
  },
  "type":{
  "@type":"string",
  "@value":"SPLIT_AND_INDEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"powershell_engine_version"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":3
  },
  "converters":[
  ],
  "configuration":{
  "regex_value":{
  "@type":"string",
  "@value":"EngineVersion=(\\d+.\\d+.\\d+.\\d+)"
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"data_win_eventdata_data"
  },
  "title":{
  "@type":"string",
  "@value":"Powershell Engine Version"
  },
  "type":{
  "@type":"string",
  "@value":"REGEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":""
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":14
  },
  "converters":[
  ],
  "configuration":{
  "list_separator":{
  "@type":"string",
  "@value":", "
  },
  "kv_separator":{
  "@type":"string",
  "@value":":"
  },
  "key_prefix":{
  "@type":"string",
  "@value":"opencti_json_"
  },
  "key_separator":{
  "@type":"string",
  "@value":"_"
  },
  "replace_key_whitespace":{
  "@type":"boolean",
  "@value":false
  },
  "key_whitespace_replacement":{
  "@type":"string",
  "@value":"_"
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"opencti_source"
  },
  "title":{
  "@type":"string",
  "@value":"OPENCTI JSON EXTRACTOR I"
  },
  "type":{
  "@type":"string",
  "@value":"JSON"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  },
  {
  "target_field":{
  "@type":"string",
  "@value":"msg_timestamp"
  },
  "condition_value":{
  "@type":"string",
  "@value":""
  },
  "order":{
  "@type":"integer",
  "@value":1
  },
  "converters":[
  {
  "type":{
  "@type":"string",
  "@value":"DATE"
  },
  "configuration":{
  "date_format":{
  "@type":"string",
  "@value":"yyyy-MM-dd'T'HH:mm:ss.SSS"
  },
  "time_zone":{
  "@type":"string",
  "@value":"Etc/UTC"
  }
  }
  }
  ],
  "configuration":{
  "regex_value":{
  "@type":"string",
  "@value":"\"timestamp\":\"([^\"]*)\\+0000\""
  }
  },
  "source_field":{
  "@type":"string",
  "@value":"message"
  },
  "title":{
  "@type":"string",
  "@value":"MSG_TIMESTAMP"
  },
  "type":{
  "@type":"string",
  "@value":"REGEX"
  },
  "cursor_strategy":{
  "@type":"string",
  "@value":"COPY"
  },
  "condition_type":{
  "@type":"string",
  "@value":"NONE"
  }
  }
  ]
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"61146e00-b60c-4d11-8722-f0e36f5bb632",
  "type":{
  "name":"lookup_cache",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"software-vendors"
  },
  "title":{
  "@type":"string",
  "@value":"Software Vendors"
  },
  "description":{
  "@type":"string",
  "@value":"Cache of approved software vendors"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"guava_cache"
  },
  "max_size":{
  "@type":"integer",
  "@value":1000
  },
  "expire_after_access":{
  "@type":"long",
  "@value":60
  },
  "expire_after_access_unit":{
  "@type":"string",
  "@value":"SECONDS"
  },
  "expire_after_write":{
  "@type":"long",
  "@value":0
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"d5566066-9a5c-4e62-8cf2-7a139f8e27c1",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 10 LOGS - WELL KNOWN SOURCE PROCESS IMAGE"
  },
  "description":{
  "@type":"string",
  "@value":"DROP SYSMON EVT 10 LOGS - WELL KNOWN SOURCE PROCESS IMAGE"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"DROP SYSMON EVT 10 LOGS - WELL KNOWN SOURCE PROCESS IMAGE\"\nwhen\n$message.rule_group3 == \"sysmon_event_10\" AND $message.data_win_eventdata_sourceImage == \"C:\\\\\\\\Program Files\\\\\\\\ATERA Networks\\\\\\\\AteraAgent\\\\\\\\AteraAgent.exe\"\nthen\n drop_message();\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"501ebf6b-51d7-4456-be86-5890777cda9b",
  "type":{
  "name":"lookup_cache",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"socfortress-threat-intel-cache"
  },
  "title":{
  "@type":"string",
  "@value":"SOCFortress Threat Intel Lookup Table"
  },
  "description":{
  "@type":"string",
  "@value":"SOCFortress Threat Intel Lookup Table"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"guava_cache"
  },
  "max_size":{
  "@type":"integer",
  "@value":1000
  },
  "expire_after_access":{
  "@type":"long",
  "@value":60
  },
  "expire_after_access_unit":{
  "@type":"string",
  "@value":"MINUTES"
  },
  "expire_after_write":{
  "@type":"long",
  "@value":0
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e87a0d5e-7bc8-4e1b-a567-0f9acc3fe61a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX OSQUERY PROCESS LIST LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX OSQUERY PROCESS LIST LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX OSQUERY PROCESS LIST LOG NORMALIZATION\"\nwhen\n$message.rule_group1 == \"osquery\" AND $message.rule_group2 == \"list_processes\"\nthen\n set_field(\"process_name\", $message.data_osquery_columns_name);\n set_field(\"process_image\", $message.data_osquery_columns_path);\n set_field(\"process_id\", $message.data_osquery_columns_pid);\n set_field(\"process_cmd_line\", $message.data_osquery_columns_cmdline);\n set_field(\"user_name\", $message.data_osquery_columns_username);\n set_field(\"parent_process_id\", $message.data_osquery_columns_parent);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"83eed16b-7d7b-4db8-b953-e469ca8abd3a",
  "type":{
  "name":"lookup_cache",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"nist-800-53-to-cui-controls"
  },
  "title":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI CONTROLS"
  },
  "description":{
  "@type":"string",
  "@value":"NIST 800-53 TO CUI CONTROLS"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"guava_cache"
  },
  "max_size":{
  "@type":"integer",
  "@value":1000
  },
  "expire_after_access":{
  "@type":"long",
  "@value":60
  },
  "expire_after_access_unit":{
  "@type":"string",
  "@value":"SECONDS"
  },
  "expire_after_write":{
  "@type":"long",
  "@value":0
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"aa1e4083-c95f-4f65-b983-a2e72a8800b1",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"OSSEC SYSCHECK ADDED - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"OSSEC SYSCHECK ADDED - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"OSSEC SYSCHECK ADDED - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"ossec\" AND $message.rule_group2 == \"syscheck\" AND $message.syscheck_event == \"added\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: to_string($message.sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"234cd538-6995-4f0e-bea0-fdb1a4589ad5",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 10 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 10 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 10 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_10\"\nthen\n set_field(\"target_image\", $message.data_win_eventdata_targetImage);\n set_field(\"granted_access\", $message.data_win_eventdata_grantedAccess);\n set_field(\"source_image\", $message.data_win_eventdata_sourceImage);\n set_field(\"call_trace\", $message.data_win_eventdata_callTrace);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"fd41552a-7756-4481-93dc-a0597ad16d40",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 1 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event1\"\nthen\n set_field(\"process_name\", $message.data_win_eventdata_originalFileName);\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"process_cmd_line\", $message.data_win_eventdata_commandLine);\n set_field(\"user_name\", $message.data_win_eventdata_user);\n set_field(\"software_vendor\", $message.data_win_eventdata_company);\n set_field(\"process_image_hashes\", $message.data_win_eventdata_hashes);\n set_field(\"software_product\", $message.data_win_eventdata_product);\n set_field(\"parent_process_image\", $message.data_win_eventdata_parentImage);\n set_field(\"parent_cmd_line\", $message.data_win_eventdata_parentCommandLine);\n set_field(\"parent_process_id\", $message.data_win_eventdata_parentProcessId);\n set_field(\"parent_process_user\", $message.data_win_eventdata_parentUser);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"a74702c1-1ebe-4127-896a-bc3d644c813e",
  "type":{
  "name":"lookup_table",
  "version":"1"
  },
  "v":"1",
  "data":{
  "default_single_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "cache_name":{
  "@type":"string",
  "@value":"501ebf6b-51d7-4456-be86-5890777cda9b"
  },
  "name":{
  "@type":"string",
  "@value":"socfortress_threat_intel"
  },
  "default_multi_value_type":{
  "@type":"string",
  "@value":"NULL"
  },
  "default_multi_value":{
  "@type":"string",
  "@value":""
  },
  "data_adapter_name":{
  "@type":"string",
  "@value":"07340722-171e-482b-a678-772cb152d584"
  },
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "title":{
  "@type":"string",
  "@value":"SOCFortress Threat Intel Lookup Table"
  },
  "default_single_value":{
  "@type":"string",
  "@value":""
  },
  "description":{
  "@type":"string",
  "@value":"SOCFortress Threat Intel Lookup Table"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"cbcf47a6-8a1d-4964-b452-1e18faed31a5",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - SIGMA - data_event_ProcessId"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS PROCESS ID - SIGMA - data_event_ProcessId"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS PROCESS ID - SIGMA - data_event_ProcessId\"\nwhen\n has_field(\"data_event_ProcessId\") AND $message.rule_group1 == \"windows\" AND $message.rule_group2 == \"chainsaw\"\nthen\n set_field(\"process_id\", $message.data_event_ProcessId);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"7dc9b4d6-8966-42f5-bde4-00274aae8ca0",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 12 LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 12 LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 12 LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_12\"\nthen\n set_field(\"process_image\", $message.data_win_eventdata_image);\n set_field(\"process_id\", $message.data_win_eventdata_processId);\n set_field(\"target_object\", $message.data_win_eventdata_targetObject);\n set_field(\"event_type\", $message.data_win_eventdata_eventType);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"6535143f-0d61-448d-87d7-95dce34a0dd5",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"MISP IoCs LOOKUP - URL"
  },
  "description":{
  "@type":"string",
  "@value":"MISP IoCs LOOKUP - URL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"MISP IoCs LOOKUP - URL\"\nwhen\n has_field(\"url_original\")\nthen\n let ldata = lookup(\n lookup_table: \"misp_query\",\n key: to_string($message.url_original)\n );\n set_fields(\n fields: ldata,\n prefix: \"misp_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e0178d9a-957f-4029-b411-115859cfe3fc",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Windows Timestamp - UTC"
  },
  "description":{
  "@type":"string",
  "@value":"Windows Timestamp - UTC"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Windows Timestamp - UTC\"\nwhen\n has_field(\"data_win_system_systemTime\")\nthen\n let time = parse_date(to_string($message.data_win_system_systemTime), \"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS'Z'\", \"Etc/UTC\");\n set_field(\"timestamp_utc\", time);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e8f784fc-da67-43b9-966f-ed7344f4a9f2",
  "type":{
  "name":"lookup_adapter",
  "version":"1"
  },
  "v":"1",
  "data":{
  "_scope":{
  "@type":"string",
  "@value":"DEFAULT"
  },
  "name":{
  "@type":"string",
  "@value":"epss"
  },
  "title":{
  "@type":"string",
  "@value":"EPSS"
  },
  "description":{
  "@type":"string",
  "@value":"https://www.first.org/epss/api - Get CVE Score"
  },
  "configuration":{
  "type":{
  "@type":"string",
  "@value":"httpjsonpath"
  },
  "url":{
  "@type":"string",
  "@value":"https://api.first.org/data/v1/epss?cve=${key}"
  },
  "single_value_jsonpath":{
  "@type":"string",
  "@value":"$.status"
  },
  "multi_value_jsonpath":{
  "@type":"string",
  "@value":"$.data[0]"
  },
  "user_agent":{
  "@type":"string",
  "@value":"Graylog Lookup - https://www.graylog.org/"
  }
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"36f316d2-65de-4022-ba52-d5d3d043ce84",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION"
  },
  "description":{
  "@type":"string",
  "@value":"LINUX SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"LINUX SYSMON EVENT 3 INBOUND CONNECTION LOG NORMALIZATION\"\nwhen\n $message.rule_group1 == \"linux\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_eventdata_initiated == \"false\"\nthen\n set_field(\"process_image\", $message.data_eventdata_image);\n set_field(\"process_id\", $message.data_eventdata_processId);\n set_field(\"protocol\", $message.data_eventdata_protocol);\n set_field(\"user_name\", $message.data_eventdata_user);\n set_field(\"dst_ip\", $message.data_eventdata_DestinationIp);\n set_field(\"dst_port\", $message.data_eventdata_destinationPort);\n set_field(\"src_ip\", $message.data_eventdata_sourceIp);\n set_field(\"src_port\", $message.data_eventdata_sourcePort);\n set_field(\"traffic_direction\", \"ingress\"); \nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"e3549fcb-737b-4649-903c-9a75136e846c",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - OPENCTI THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 7 - OPENCTI THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 7 - OPENCTI THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event7\" AND ! has_field(\"misp_category\")\nthen\n let ldata = lookup(\n lookup_table: \"opencti_hash\",\n key: to_string($message.sha256)\n );\n set_fields(\n fields: ldata,\n prefix: \"opencti\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"7f1097bb-90ab-48f1-9712-a7fa7f06b26a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 3 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event3\" AND $message.data_win_eventdata_destinationIp != \"127.0.0.1\" AND $message.data_win_eventdata_destinationIp != \"255.255.255.255\" AND $message.data_win_eventdata_destinationIp != \"0.0.0.0\" AND $message.data_win_eventdata_destinationIsIpv6 == \"false\" AND !in_private_net(to_string($message.data_win_eventdata_destinationIp))\nthen\n let ip_and_ampersand = concat(to_string($message.data_win_eventdata_destinationIp), \"&customer_code=\");\n let new_key = concat(ip_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"b03f187c-e4f3-47a1-a0e3-a8afb0504454",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Linux Sysmon Timestamp - UTC"
  },
  "description":{
  "@type":"string",
  "@value":"Linux Sysmon Timestamp - UTC"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Linux Sysmon Timestamp - UTC\"\nwhen\n has_field(\"data_system_systemTime\")\nthen\n let time = parse_date(to_string($message.data_system_systemTime), \"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS'Z'\", \"Etc/UTC\");\n set_field(\"timestamp_utc\", time);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"aab186ca-9acf-4665-8423-82cdb5834180",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 6 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 6 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 6 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event6\" AND $message.data_win_eventdata_signed == \"false\"\nthen\n let sha256_and_ampersand = concat(to_string($message.sha256), \"&customer_code=\");\n let new_key = concat(sha256_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"3c6bea66-7f56-4237-b47a-167162947cfa",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - SOFTWARE VENDORS"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 1 - SOFTWARE VENDORS"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 1 - SOFTWARE VENDORS\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event1\" AND has_field(\"data_win_eventdata_company\")\nthen\n let ldata = lookup_value(\n lookup_table: \"software-vendors\",\n key: to_string($message.data_win_eventdata_company)\n );\n set_field(\"software_approved\", ldata);\n let build_message_0 = to_string(\" Sysmon - Event 1: Process creation \");\n let build_message_1 = concat(build_message_0, to_string($message.data_win_eventdata_description));\n set_field(\"second_rule_description\", build_message_1);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"68ce0424-52f8-4d8d-a8af-b71a769d700a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WAZUH CREATE FIELD SYSLOG LEVEL - NOTICE"
  },
  "description":{
  "@type":"string",
  "@value":"WAZUH CREATE FIELD SYSLOG LEVEL - NOTICE"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WAZUH CREATE FIELD SYSLOG LEVEL - NOTICE\"\nwhen to_long($message.rule_level) > 3 AND to_long($message.rule_level) < 8\nthen\nset_field(\"syslog_level\", \"NOTICE\");\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"763dfd5f-ebfd-4d6e-bc95-2f306c33dc1a",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 15 - SOCFORTRESS THREAT INTEL"
  },
  "description":{
  "@type":"string",
  "@value":"WINDOWS SYSMON EVENT 15 - SOCFORTRESS THREAT INTEL"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"WINDOWS SYSMON EVENT 15 - SOCFORTRESS THREAT INTEL\"\nwhen\n $message.rule_group1 == \"windows\" AND $message.rule_group3 == \"sysmon_event_15\"\nthen\n let sha256_and_ampersand = concat(to_string($message.sha256), \"&customer_code=\");\n let new_key = concat(sha256_and_ampersand, to_string($message.agent_labels_customer));\n let ldata = lookup(\n lookup_table: \"socfortress_threat_intel\",\n key: new_key\n );\n set_fields(\n fields: ldata,\n prefix: \"threat_intel_\"\n );\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"c4419a08-379e-4604-b34f-f6824ef1e541",
  "type":{
  "name":"pipeline_rule",
  "version":"1"
  },
  "v":"1",
  "data":{
  "title":{
  "@type":"string",
  "@value":"Office365 Timestamp - UTC"
  },
  "description":{
  "@type":"string",
  "@value":"Office365 Timestamp - UTC"
  },
  "source":{
  "@type":"string",
  "@value":"rule \"Office365 Timestamp - UTC\"\nwhen\n has_field(\"data_office_365_CreationTime\")\nthen\n let creation_time = $message.data_office_365_CreationTime;\n set_field(\"timestamp_utc\", creation_time);\nend"
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"deec9ffd-b8c2-4b2b-a2a0-6c4556b8f0a6",
  "type":{
  "name":"stream",
  "version":"1"
  },
  "v":"1",
  "data":{
  "alarm_callbacks":[
  ],
  "outputs":[
  ],
  "remove_matches":{
  "@type":"boolean",
  "@value":true
  },
  "title":{
  "@type":"string",
  "@value":"GAIN - WAZUH EDR EVENTS"
  },
  "stream_rules":[
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"syslog_type"
  },
  "value":{
  "@type":"string",
  "@value":"wazuh"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"agent_labels_customer"
  },
  "value":{
  "@type":"string",
  "@value":"gain"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  }
  ],
  "alert_conditions":[
  ],
  "matching_type":{
  "@type":"string",
  "@value":"AND"
  },
  "disabled":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":"GAIN - WAZUH EDR EVENTS"
  },
  "default_stream":{
  "@type":"boolean",
  "@value":false
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"25cf5186-343d-43e6-acea-2e690e0c7f55",
  "type":{
  "name":"stream",
  "version":"1"
  },
  "v":"1",
  "data":{
  "alarm_callbacks":[
  ],
  "outputs":[
  ],
  "remove_matches":{
  "@type":"boolean",
  "@value":true
  },
  "title":{
  "@type":"string",
  "@value":"ACAPS - WAZUH EDR EVENTS"
  },
  "stream_rules":[
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"syslog_type"
  },
  "value":{
  "@type":"string",
  "@value":"wazuh"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"agent_labels_customer"
  },
  "value":{
  "@type":"string",
  "@value":"acaps"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  }
  ],
  "alert_conditions":[
  ],
  "matching_type":{
  "@type":"string",
  "@value":"AND"
  },
  "disabled":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":"ACAPS - WAZUH EDR EVENTS"
  },
  "default_stream":{
  "@type":"boolean",
  "@value":false
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  },
  {
  "id":"4d9017e0-3943-4382-8978-adbc45bbe5cb",
  "type":{
  "name":"stream",
  "version":"1"
  },
  "v":"1",
  "data":{
  "alarm_callbacks":[
  ],
  "outputs":[
  ],
  "remove_matches":{
  "@type":"boolean",
  "@value":true
  },
  "title":{
  "@type":"string",
  "@value":"GAIN - WAZUH EDR EVENTS - CLUSTER MATCH"
  },
  "stream_rules":[
  {
  "type":{
  "@type":"string",
  "@value":"EXACT"
  },
  "field":{
  "@type":"string",
  "@value":"cluster_node"
  },
  "value":{
  "@type":"string",
  "@value":"wazuh.worker.gain"
  },
  "inverted":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  },
  {
  "type":{
  "@type":"string",
  "@value":"PRESENCE"
  },
  "field":{
  "@type":"string",
  "@value":"agent_labels_customer"
  },
  "value":{
  "@type":"string",
  "@value":""
  },
  "inverted":{
  "@type":"boolean",
  "@value":true
  },
  "description":{
  "@type":"string",
  "@value":""
  }
  }
  ],
  "alert_conditions":[
  ],
  "matching_type":{
  "@type":"string",
  "@value":"AND"
  },
  "disabled":{
  "@type":"boolean",
  "@value":false
  },
  "description":{
  "@type":"string",
  "@value":"Stream to match on cluster_node rather than agent label"
  },
  "default_stream":{
  "@type":"boolean",
  "@value":false
  }
  },
  "constraints":[
  {
  "type":"server-version",
  "version":">=5.0.10+40c8c33"
  }
  ]
  }
  ]
  }
